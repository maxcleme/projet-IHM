<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Filandar</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <link rel="stylesheet" href="css/bootstrap.css" media="screen">
    <link rel="stylesheet" href="css/contrainte.css" media="screen">
    <link rel="stylesheet" href="css/jquery-ui.min.css" media="screen">
  </head>
  <body>
    <div class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <a href="../" class="navbar-brand">Filandar - <strong>Votre</strong> calendrier</a>
        </div>
      </div>
    </div>


    <div class="container" style="margin-top: 100px;">
   
      <div class="jumbotron form-horizontal"  id="div-ajouter-contrainte">
        <a  style="float:center;color:red;font-weight:bold;" id="chrono" href="votes_profs.html"></a>
         <span id="log" style="float:right;color:black;" >enregistré</span>
        <h3>Ajouter une contrainte</h3>
        <div class="col-md-4 form-group">
           <input class="form-control col-md-3" name="motif" id="motif" placeholder="Saisir un motif" autocomplete="off"/>
        </div>
        <div class="col-md-4 form-group">
        <select size="1" name="niveau" id="niveau" class="form-control col-md-4" autocomplete="off">
          <option >Saisir un niveau de priorité</option>
          <option>Indispensable</option>
          <option>Préférable</option>
          <option>Souhaité</option>
        </select>
      </div>
      <br>

      <div id="draggable-div" title="Déplacer cette contrainte dans le calendrier">
        <em>A déplacer dans le calendrier</em><br>
         <center><span class="btn btn-info"  id="contrainte-exemple"><span>--</span><em>--</em></span></center>
      </div>
     
      </div>
      <div class="jumbotron">
          <table id="calendar-contraint">
            <tr><th></th><th>Lundi</th><th>Mardi</th><th>Mercredi</th><th>Jeudi</th><th>Vendredi</th><th>Samedi</th></tr>
            <tr><th>8h00</th><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            <tr><th>8h30</th><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            <tr><th>9h00</th><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            <tr><th>9h30</th><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            <tr><th>10h00</th><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            <tr><th>10h30</th><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            <tr><th>11h00</th><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            <tr><th>11h30</th><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            <tr><th>12h00</th><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            <tr><th>12h30</th><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            <tr><th>13h00</th><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            <tr><th>13h30</th><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            <tr><th>14h00</th><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            <tr><th>14h30</th><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            <tr><th>15h00</th><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            <tr><th>15h30</th><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            <tr><th>16h00</th><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            <tr><th>16h30</th><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            <tr><th>17h00</th><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            <tr><th>17h30</th><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            <tr><th>18h00</th><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            <tr><th>18h30</th><td></td><td></td><td></td><td></td><td></td><td></td></tr>
            <tr><th>19h00</th><td></td><td></td><td></td><td></td><td></td><td></td></tr>
          </table>
      </div>
    </div>
    <script src="js/jquery.js"></script>
    <script src="js/jquery-ui.min.js"></script>
    <script>

      function chrono(time) {
        var d = new Date(time)

        $("#chrono").html( "Il reste " + d.getHours() + "h" + d.getMinutes() + "m" + d.getSeconds() +  "s pour ajouter vos contraintes de temps"  );

        setTimeout('chrono('  +  (time - 1000 ) +')', 1000);
      }
      chrono(670000);

      var niveau  = false;
      var motif   = false;
      var deletable = true;
      $("#draggable-div").tooltip({show: {duration: 400 ,width:300}});
      $("#contrainte-exemple").draggable({revert : true});

      function supprimer(current) {
        enregistrer();
        if(deletable)
          $(current).remove()
      }

      function enregistrer() {
        $("#log").html("en cours");
        setTimeout(function() {
               $("#log").html("enregistré");
          }, 500);
      }

      $( "#calendar-contraint td" ).droppable({
          drop: function( event, ui ) {
            enregistrer();
            if(motif && niveau){
              $(this).append("<span class='supprimable btn btn-info' title='Supprimer' onClick='supprimer(this);'>" + $(ui.draggable).html() + "</span>");
              $(".btn-info").tooltip();
            }
            else {
              alert("veuillez saisir une motif et une priorité");
            }
          }
      });

      $("td").mouseover(function () {
        $(this).parent().css("color","blue");
        $(this).parent().css("text-decoration","underline");
      });

      $("td").mouseleave(function () {
        $(this).parent().css("color","black");
        $(this).parent().css("text-decoration","none");
      });

      $("#motif").keyup(function(){
        motif = true;
        $("#contrainte-exemple span").html($(this).val());
      });

      $("#niveau").change(function(){
        niveau = true;
        $("#contrainte-exemple em").html($(this).val());
      }); 

      $("#niveau").change(function(){
        $("#draggable-div").tooltip( "open" );
      });
    </script>
</body>
</html>
